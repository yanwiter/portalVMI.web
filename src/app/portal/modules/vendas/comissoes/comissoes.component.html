<div class="comissoes-container">
  <div class="header-section">
    <div class="title-section">
      <h1>{{ 'COMISSOES' | translate }}</h1>
      <p>{{ 'COMISSOES_DESC' | translate }}</p>
    </div>
    <div class="actions-section">
      <p-button 
        icon="pi pi-plus" 
        [label]="'NOVA_COMISSAO' | translate"
        (onClick)="openNewComissao()"
        class="p-button-success">
      </p-button>
    </div>
  </div>

  <!-- Resumo -->
  <div class="summary-section">
    <div class="summary-cards">
      <p-card class="summary-card">
        <div class="card-content">
          <div class="icon-section">
            <i class="pi pi-dollar"></i>
          </div>
          <div class="info-section">
            <h3>{{ 'TOTAL_COMISSOES' | translate }}</h3>
            <span class="value">{{ getTotalComissoes() | currency:'BRL' }}</span>
          </div>
        </div>
      </p-card>
      
      <p-card class="summary-card">
        <div class="card-content">
          <div class="icon-section">
            <i class="pi pi-chart-line"></i>
          </div>
          <div class="info-section">
            <h3>{{ 'TOTAL_VENDAS' | translate }}</h3>
            <span class="value">{{ getTotalVendas() | currency:'BRL' }}</span>
          </div>
        </div>
      </p-card>
      
      <p-card class="summary-card">
        <div class="card-content">
          <div class="icon-section">
            <i class="pi pi-users"></i>
          </div>
          <div class="info-section">
            <h3>{{ 'TOTAL_VENDEDORES' | translate }}</h3>
            <span class="value">{{ getTotalVendedores() }}</span>
          </div>
        </div>
      </p-card>
    </div>
  </div>

  <!-- Lista de Comissões -->
  <p-card [header]="'COMISSOES' | translate">
    <p-table [value]="comissoes" [paginator]="true" [rows]="10" 
             [showCurrentPageReport]="true" 
             currentPageReportTemplate="{{ 'SHOWING' | translate }} {first} {{ 'TO' | translate }} {last} {{ 'OF' | translate }} {totalRecords} {{ 'ENTRIES' | translate }}"
             [rowsPerPageOptions]="[5, 10, 25]">
      
      <ng-template pTemplate="header">
        <tr>
          <th>{{ 'VENDEDOR' | translate }}</th>
          <th>{{ 'MES' | translate }}</th>
          <th>{{ 'VENDAS_REALIZADAS' | translate }}</th>
          <th>{{ 'VALOR_VENDAS' | translate }}</th>
          <th>{{ 'PERCENTUAL_COMISSAO' | translate }}</th>
          <th>{{ 'VALOR_COMISSAO' | translate }}</th>
          <th>{{ 'STATUS' | translate }}</th>
          <th>{{ 'DATA_PAGAMENTO' | translate }}</th>
          <th>{{ 'ACOES' | translate }}</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-comissao>
        <tr>
          <td>{{ comissao.vendedor }}</td>
          <td>{{ comissao.mes }}</td>
          <td>{{ comissao.vendasRealizadas }}</td>
          <td>{{ comissao.valorVendas | currency:'BRL' }}</td>
          <td>{{ comissao.percentualComissao }}%</td>
          <td>{{ comissao.valorComissao | currency:'BRL' }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(comissao.status)">
              <i [class]="getStatusIcon(comissao.status)"></i>
              {{ comissao.status | titlecase }}
            </span>
          </td>
          <td>{{ comissao.dataPagamento | date:'dd/MM/yyyy' || '-' }}</td>
          <td>
            <div class="action-buttons">
              <p-button 
                icon="pi pi-pencil" 
                [label]="'EDITAR' | translate"
                (onClick)="editComissao(comissao)"
                class="p-button-primary p-button-sm">
              </p-button>
              <p-button 
                icon="pi pi-trash" 
                [label]="'EXCLUIR' | translate"
                (onClick)="deleteComissao(comissao)"
                class="p-button-danger p-button-sm">
              </p-button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>

<!-- Dialog para criar/editar comissão -->
<p-dialog 
  [(visible)]="displayDialog" 
  [header]="(isNewComissao ? 'NOVA_COMISSAO' : 'EDITAR_COMISSAO') | translate"
  [modal]="true" 
  [style]="{width: '800px'}"
  [draggable]="false" 
  [resizable]="false">
  
  <div class="dialog-content" *ngIf="selectedComissao">
    <div class="form-row">
      <div class="form-field">
        <label for="vendedor">{{ 'VENDEDOR' | translate }} *</label>
        <p-dropdown 
          id="vendedor"
          [options]="vendedores" 
          [(ngModel)]="selectedComissao.vendedor"
          placeholder="{{ 'SELECIONE_VENDEDOR' | translate }}"
          class="w-full">
        </p-dropdown>
      </div>
      <div class="form-field">
        <label for="mes">{{ 'MES' | translate }} *</label>
        <p-dropdown 
          id="mes"
          [options]="meses" 
          [(ngModel)]="selectedComissao.mes"
          placeholder="{{ 'SELECIONE_MES' | translate }}"
          class="w-full">
        </p-dropdown>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-field">
        <label for="vendasRealizadas">{{ 'VENDAS_REALIZADAS' | translate }} *</label>
        <p-inputNumber 
          id="vendasRealizadas"
          [(ngModel)]="selectedComissao.vendasRealizadas"
          [min]="0"
          [showButtons]="true"
          class="w-full">
        </p-inputNumber>
      </div>
      <div class="form-field">
        <label for="valorVendas">{{ 'VALOR_VENDAS' | translate }} *</label>
        <p-inputNumber 
          id="valorVendas"
          [(ngModel)]="selectedComissao.valorVendas"
          [min]="0"
          [showButtons]="true"
          prefix="R$ "
          class="w-full">
        </p-inputNumber>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-field">
        <label for="percentualComissao">{{ 'PERCENTUAL_COMISSAO' | translate }} (%)</label>
        <p-inputNumber 
          id="percentualComissao"
          [(ngModel)]="selectedComissao.percentualComissao"
          [min]="0"
          [max]="100"
          [showButtons]="true"
          suffix="%"
          class="w-full">
        </p-inputNumber>
      </div>
      <div class="form-field">
        <label for="valorComissao">{{ 'VALOR_COMISSAO' | translate }} *</label>
        <p-inputNumber 
          id="valorComissao"
          [(ngModel)]="selectedComissao.valorComissao"
          [min]="0"
          [showButtons]="true"
          prefix="R$ "
          class="w-full">
        </p-inputNumber>
      </div>
    </div>
  </div>
  
  <ng-template pTemplate="footer">
    <p-button 
      [label]="'CANCELAR' | translate"
      icon="pi pi-times" 
      (onClick)="displayDialog = false"
      class="p-button-text">
    </p-button>
    <p-button 
      [label]="'SALVAR' | translate"
      icon="pi pi-check" 
      (onClick)="saveComissao()"
      class="p-button-success">
    </p-button>
  </ng-template>
</p-dialog>

<p-toast></p-toast> 